{"ast":null,"code":"let signalSupported = false;\n\nfunction noop() {}\n\ntry {\n  const options = Object.create({}, {\n    signal: {\n      get() {\n        signalSupported = true;\n      }\n\n    }\n  });\n  window.addEventListener('test', noop, options);\n  window.removeEventListener('test', noop, options);\n} catch (e) {}\n\nfunction featureSupported() {\n  return signalSupported;\n}\n\nfunction monkeyPatch() {\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  const originalAddEventListener = EventTarget.prototype.addEventListener;\n\n  EventTarget.prototype.addEventListener = function (name, originalCallback, optionsOrCapture) {\n    if (typeof optionsOrCapture === 'object' && 'signal' in optionsOrCapture && optionsOrCapture.signal instanceof AbortSignal) {\n      originalAddEventListener.call(optionsOrCapture.signal, 'abort', () => {\n        this.removeEventListener(name, originalCallback, optionsOrCapture);\n      });\n    }\n\n    return originalAddEventListener.call(this, name, originalCallback, optionsOrCapture);\n  };\n}\n\nexport function polyfill() {\n  if (!featureSupported()) {\n    monkeyPatch();\n    signalSupported = true;\n  }\n}","map":{"version":3,"sources":["/Users/steve/Documents/repos/github-notifications/node_modules/@primer/behaviors/dist/esm/polyfills/event-listener-signal.js"],"names":["signalSupported","noop","options","Object","create","signal","get","window","addEventListener","removeEventListener","e","featureSupported","monkeyPatch","originalAddEventListener","EventTarget","prototype","name","originalCallback","optionsOrCapture","AbortSignal","call","polyfill"],"mappings":"AAAA,IAAIA,eAAe,GAAG,KAAtB;;AACA,SAASC,IAAT,GAAgB,CAAG;;AACnB,IAAI;AACA,QAAMC,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB;AAC9BC,IAAAA,MAAM,EAAE;AACJC,MAAAA,GAAG,GAAG;AACFN,QAAAA,eAAe,GAAG,IAAlB;AACH;;AAHG;AADsB,GAAlB,CAAhB;AAOAO,EAAAA,MAAM,CAACC,gBAAP,CAAwB,MAAxB,EAAgCP,IAAhC,EAAsCC,OAAtC;AACAK,EAAAA,MAAM,CAACE,mBAAP,CAA2B,MAA3B,EAAmCR,IAAnC,EAAyCC,OAAzC;AACH,CAVD,CAWA,OAAOQ,CAAP,EAAU,CACT;;AACD,SAASC,gBAAT,GAA4B;AACxB,SAAOX,eAAP;AACH;;AACD,SAASY,WAAT,GAAuB;AACnB,MAAI,OAAOL,MAAP,KAAkB,WAAtB,EAAmC;AAC/B;AACH;;AACD,QAAMM,wBAAwB,GAAGC,WAAW,CAACC,SAAZ,CAAsBP,gBAAvD;;AACAM,EAAAA,WAAW,CAACC,SAAZ,CAAsBP,gBAAtB,GAAyC,UAAUQ,IAAV,EAAgBC,gBAAhB,EAAkCC,gBAAlC,EAAoD;AACzF,QAAI,OAAOA,gBAAP,KAA4B,QAA5B,IACA,YAAYA,gBADZ,IAEAA,gBAAgB,CAACb,MAAjB,YAAmCc,WAFvC,EAEoD;AAChDN,MAAAA,wBAAwB,CAACO,IAAzB,CAA8BF,gBAAgB,CAACb,MAA/C,EAAuD,OAAvD,EAAgE,MAAM;AAClE,aAAKI,mBAAL,CAAyBO,IAAzB,EAA+BC,gBAA/B,EAAiDC,gBAAjD;AACH,OAFD;AAGH;;AACD,WAAOL,wBAAwB,CAACO,IAAzB,CAA8B,IAA9B,EAAoCJ,IAApC,EAA0CC,gBAA1C,EAA4DC,gBAA5D,CAAP;AACH,GATD;AAUH;;AACD,OAAO,SAASG,QAAT,GAAoB;AACvB,MAAI,CAACV,gBAAgB,EAArB,EAAyB;AACrBC,IAAAA,WAAW;AACXZ,IAAAA,eAAe,GAAG,IAAlB;AACH;AACJ","sourcesContent":["let signalSupported = false;\nfunction noop() { }\ntry {\n    const options = Object.create({}, {\n        signal: {\n            get() {\n                signalSupported = true;\n            }\n        }\n    });\n    window.addEventListener('test', noop, options);\n    window.removeEventListener('test', noop, options);\n}\ncatch (e) {\n}\nfunction featureSupported() {\n    return signalSupported;\n}\nfunction monkeyPatch() {\n    if (typeof window === 'undefined') {\n        return;\n    }\n    const originalAddEventListener = EventTarget.prototype.addEventListener;\n    EventTarget.prototype.addEventListener = function (name, originalCallback, optionsOrCapture) {\n        if (typeof optionsOrCapture === 'object' &&\n            'signal' in optionsOrCapture &&\n            optionsOrCapture.signal instanceof AbortSignal) {\n            originalAddEventListener.call(optionsOrCapture.signal, 'abort', () => {\n                this.removeEventListener(name, originalCallback, optionsOrCapture);\n            });\n        }\n        return originalAddEventListener.call(this, name, originalCallback, optionsOrCapture);\n    };\n}\nexport function polyfill() {\n    if (!featureSupported()) {\n        monkeyPatch();\n        signalSupported = true;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}