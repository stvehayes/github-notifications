"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireDefault(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _ = require("../..");

var _constants = require("../../constants");

var _ChoiceFieldset = require("./ChoiceFieldset");

var _ChoiceFieldsetListContext = _interopRequireDefault(require("./ChoiceFieldsetListContext"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const List = _styledComponents.default.ul.withConfig({
  displayName: "ChoiceFieldsetList__List",
  componentId: "sc-o960a8-0"
})(["display:flex;flex-direction:column;list-style:none;margin:0;padding:0;> li + li{margin-top:", ";}"], (0, _constants.get)('space.2'));

const getSelectedCheckboxes = (value, checked, selectedValues, selectionVariant) => {
  if (checked) {
    return selectionVariant === 'multiple' ? [...selectedValues, value] : [value];
  }

  return selectedValues.filter(selectedValue => selectedValue !== value);
};

const ChoiceFieldsetList = ({
  selectionVariant,
  children
}) => {
  const ssrSafeUniqueName = (0, _.useSSRSafeId)();
  return /*#__PURE__*/_react.default.createElement(_ChoiceFieldset.Slot, {
    name: "ChoiceList"
  }, ({
    name,
    onSelect,
    disabled,
    selected = []
  }) => {
    return /*#__PURE__*/_react.default.createElement(_ChoiceFieldsetListContext.default.Provider, {
      value: {
        disabled,
        selected,
        name: name || ssrSafeUniqueName,
        onChange: e => {
          const updatedSelections = getSelectedCheckboxes(e.currentTarget.value, e.currentTarget.checked, selected, selectionVariant);
          onSelect && onSelect(updatedSelections);
        },
        selectionVariant
      }
    }, /*#__PURE__*/_react.default.createElement(List, null, _react.default.Children.map(children, (child, i) => /*#__PURE__*/_react.default.createElement("li", {
      key: i
    }, child))));
  });
};

ChoiceFieldsetList.displayName = "ChoiceFieldsetList";
ChoiceFieldsetList.defaultProps = {
  selectionVariant: 'single'
};
var _default = ChoiceFieldsetList;
exports.default = _default;